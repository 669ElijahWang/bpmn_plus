# BPMN Plus â€” BPMN æ ¼å¼è½¬æ¢å·¥å…·

å°†éæ ‡å‡† BPMN æ–‡ä»¶æ‰¹é‡è½¬æ¢ä¸º **Camunda Cloud (Zeebe)** æ ‡å‡†æ ¼å¼ï¼Œä½¿å…¶å¯è¢« Camunda Modeler æ­£å¸¸å¯¼å…¥å’Œç¼–è¾‘ã€‚

---

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

- **æ ¼å¼è‡ªåŠ¨è½¬æ¢**ï¼šå°†å„ç±»éæ ‡å‡† BPMN XML è½¬æ¢ä¸º Camunda Cloud (Zeebe) æ ‡å‡†æ ¼å¼
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒåŒæ—¶ä¸Šä¼ å’Œè½¬æ¢å¤šä¸ª `.bpmn` æ–‡ä»¶
- **Web ç•Œé¢**ï¼šæä¾›å¯è§†åŒ–æ‹–æ‹½ä¸Šä¼ ç•Œé¢ï¼Œæ“ä½œç®€ä¾¿
- **å‘½ä»¤è¡Œæ”¯æŒ**ï¼šæ”¯æŒé€šè¿‡å‘½ä»¤è¡Œå•æ–‡ä»¶æˆ–æ‰¹é‡è½¬æ¢
- **è‡ªå®šä¹‰æ ‡ç­¾å…¼å®¹**ï¼šè‡ªåŠ¨è¯†åˆ«éæ ‡å‡†æ ‡ç­¾ï¼ˆå¦‚ `countersignTask` ä¼šç­¾ä»»åŠ¡ï¼‰ï¼Œå¹¶æ˜ å°„ä¸ºæ ‡å‡† BPMN å…ƒç´ 
- **å›¾å½¢å¸ƒå±€ä¿ç•™**ï¼šä¿ç•™åŸå§‹æ–‡ä»¶ä¸­çš„èŠ‚ç‚¹åæ ‡å’Œå›¾å½¢ä¿¡æ¯

### è½¬æ¢å†…å®¹

| é¡¹ç›® | è½¬æ¢å‰ | è½¬æ¢å |
|------|--------|--------|
| å…ƒç´ å‰ç¼€ | æ— å‰ç¼€æˆ–æ··åˆå‰ç¼€ | ç»Ÿä¸€ `bpmn:` å‰ç¼€ |
| å‘½åç©ºé—´ | ç¼ºå¤±æˆ–ä¸å®Œæ•´ | å®Œæ•´çš„ Camunda Cloud å‘½åç©ºé—´ |
| å›¾å½¢å®šä¹‰ | å¯èƒ½ç¼ºå¤±å®½é«˜ | è¡¥å…¨ `BPMNShape`ã€`BPMNEdge` åŠå°ºå¯¸ |
| æ¡ä»¶è¡¨è¾¾å¼ | åŸå§‹æ ¼å¼ | FEEL è¡¨è¾¾å¼æ ¼å¼ï¼ˆ`=` å‰ç¼€ï¼‰ |
| éæ ‡å‡†æ ‡ç­¾ | `countersignTask` ç­‰ | æ˜ å°„ä¸º `bpmn:userTask` |
| æ‰§è¡Œå¹³å° | æ— å£°æ˜ | Camunda Cloud 8.8.0 |

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
bpmn_plus/
â”œâ”€â”€ app.py              # Web åº”ç”¨ï¼ˆFastAPIï¼‰
â”œâ”€â”€ convert_bpmn.py     # è½¬æ¢æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ requirements.txt    # Python ä¾èµ–
â”œâ”€â”€ Dockerfile          # Docker æ„å»ºæ–‡ä»¶
â””â”€â”€ README.md           # æœ¬æ–‡æ¡£
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- pip

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### æ–¹å¼ä¸€ï¼šWeb ç•Œé¢ï¼ˆæ¨èï¼‰

```bash
python app.py
```

å¯åŠ¨åè®¿é—®ï¼š**http://localhost:9998**

ä½¿ç”¨æ–¹æ³•ï¼š
1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ä¸Šè¿°åœ°å€
2. å°† `.bpmn` æ–‡ä»¶æ‹–å…¥ä¸Šä¼ åŒºåŸŸï¼ˆæ”¯æŒæ‰¹é‡ï¼‰
3. ç‚¹å‡»ã€Œå¼€å§‹è½¬æ¢ã€
4. è½¬æ¢å®Œæˆåï¼Œç‚¹å‡»æ¯ä¸ªæ–‡ä»¶æ—çš„ã€Œä¸‹è½½ã€æŒ‰é’®è·å–ç»“æœ

### æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œ

```bash
# è½¬æ¢å•ä¸ªæ–‡ä»¶
python convert_bpmn.py your_file.bpmn

# æ‰¹é‡è½¬æ¢å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ .bpmn æ–‡ä»¶
python convert_bpmn.py .
```

è½¬æ¢åçš„æ–‡ä»¶ä¼šè‡ªåŠ¨å‘½åä¸º `åŸæ–‡ä»¶å_camunda.bpmn`ã€‚

---

## ğŸ³ Docker éƒ¨ç½²

### æ„å»ºé•œåƒ

```bash
docker build -t bpmn-plus .
```

### è¿è¡Œå®¹å™¨

```bash
docker run -d --name bpmn-plus -p 9998:9998 --restart always bpmn-plus
```

è®¿é—®ï¼š**http://æœåŠ¡å™¨IP:9998**

### å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps | grep bpmn-plus

# æŸ¥çœ‹æ—¥å¿—
docker logs bpmn-plus

# åœæ­¢å®¹å™¨
docker stop bpmn-plus

# åˆ é™¤å®¹å™¨
docker rm bpmn-plus

# åœæ­¢å¹¶åˆ é™¤ï¼ˆä¸€æ­¥å®Œæˆï¼‰
docker rm -f bpmn-plus

# åˆ é™¤é•œåƒ
docker rmi bpmn-plus
```

### æ›´æ–°éƒ¨ç½²

ä¿®æ”¹ä»£ç åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°éƒ¨ç½²ï¼š

```bash
docker rm -f bpmn-plus
docker build -t bpmn-plus .
docker run -d --name bpmn-plus -p 9998:9998 --restart always bpmn-plus
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### ç«¯å£ä¿®æ”¹

å¦‚éœ€ä¿®æ”¹è¿è¡Œç«¯å£ï¼Œéœ€åŒæ—¶ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶ï¼š

**`app.py`**ï¼ˆæœ€åä¸€è¡Œï¼‰ï¼š
```python
uvicorn.run(app, host="0.0.0.0", port=9998)  # ä¿®æ”¹ port å€¼
```

**`Dockerfile`**ï¼š
```dockerfile
EXPOSE 9998                                                    # ä¿®æ”¹ç«¯å£
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "9998"]  # ä¿®æ”¹ç«¯å£
```

### æ‰©å±•è‡ªå®šä¹‰æ ‡ç­¾

å¦‚æœæºæ–‡ä»¶ä¸­åŒ…å«å…¶ä»–éæ ‡å‡† BPMN æ ‡ç­¾ï¼Œå¯åœ¨ `convert_bpmn.py` çš„ `CUSTOM_TAG_MAP` ä¸­æ·»åŠ æ˜ å°„ï¼š

```python
CUSTOM_TAG_MAP = {
    "countersignTask": "userTask",      # ä¼šç­¾ä»»åŠ¡ â†’ ç”¨æˆ·ä»»åŠ¡
    "multiInstanceTask": "userTask",    # å¤šå®ä¾‹ä»»åŠ¡ â†’ ç”¨æˆ·ä»»åŠ¡
    "yourCustomTag": "serviceTask",     # è‡ªå®šä¹‰æ ‡ç­¾ â†’ æœåŠ¡ä»»åŠ¡
}
```

---

## ğŸ“ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ |
|------|------|
| åç«¯æ¡†æ¶ | FastAPI |
| ASGI æœåŠ¡å™¨ | Uvicorn |
| è½¬æ¢å¼•æ“ | æ­£åˆ™è¡¨è¾¾å¼è§£æ + XML æ¨¡æ¿é‡å»º |
| å‰ç«¯ | HTML / CSS / JavaScriptï¼ˆå†…åµŒï¼‰ |
| å®¹å™¨åŒ– | Docker |
| Python ç‰ˆæœ¬ | 3.8+ |
